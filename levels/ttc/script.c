#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"

/* Fast64 begin persistent block [includes] */
/* Fast64 end persistent block [includes] */

#include "make_const_nonconst.h"
#include "levels/ttc/header.h"

/* Fast64 begin persistent block [scripts] */
/* Fast64 end persistent block [scripts] */

const LevelScript level_ttc_entry[] = {
	INIT_LEVEL(),
	LOAD_YAY0(0x07, _ttc_segment_7SegmentRomStart, _ttc_segment_7SegmentRomEnd), 
	LOAD_YAY0_TEXTURE(0x09, _machine_yay0SegmentRomStart, _machine_yay0SegmentRomEnd), 
	LOAD_YAY0(0x05, _group1_yay0SegmentRomStart, _group1_yay0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group1_geoSegmentRomStart, _group1_geoSegmentRomEnd), 
	LOAD_YAY0(0x08, _common0_yay0SegmentRomStart, _common0_yay0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	LOAD_MIO0(0x7, _ttc_segment_7SegmentRomStart, _ttc_segment_7SegmentRomEnd), 
	LOAD_MIO0(0xa, _cloud_floor_skybox_mio0SegmentRomStart, _cloud_floor_skybox_mio0SegmentRomEnd), 
	LOAD_MIO0(0x5, _group1_mio0SegmentRomStart, _group1_mio0SegmentRomEnd), 
	LOAD_MIO0(0x6, _group14_mio0SegmentRomStart, _group14_mio0SegmentRomEnd), 
	LOAD_RAW(0xd, _group14_geoSegmentRomStart, _group14_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_2), 
	JUMP_LINK(script_func_global_15), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_ROTATING_CUBE, ttc_geo_000240), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_ROTATING_PRISM, ttc_geo_000258), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_PENDULUM, ttc_geo_000270), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_LARGE_TREADMILL, ttc_geo_000288), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_SMALL_TREADMILL, ttc_geo_0002A8), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_PUSH_BLOCK, ttc_geo_0002C8), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_ROTATING_HEXAGON, ttc_geo_0002E0), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_ROTATING_TRIANGLE, ttc_geo_0002F8), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_PIT_BLOCK, ttc_geo_000310), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_PIT_BLOCK_UNUSED, ttc_geo_000328), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_ELEVATOR_PLATFORM, ttc_geo_000340), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_CLOCK_HAND, ttc_geo_000358), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_SPINNER, ttc_geo_000370), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_SMALL_GEAR, ttc_geo_000388), 
	LOAD_MODEL_FROM_GEO(MODEL_TTC_LARGE_GEAR, ttc_geo_0003A0), 
	LOAD_MODEL_FROM_GEO(MODEL_THI_WARP_PIPE, warp_pipe_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_CASTLE_DOOR_0_STARS, castle_door_0_star_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_CASTLE_GROUNDS_BUBBLY_TREE, bubbly_tree_geo), 

	/* Fast64 begin persistent block [level commands] */
	/* Fast64 end persistent block [level commands] */

	AREA(1, ttc_area_1),
		WARP_NODE(6, LEVEL_BOB, 1, 10, WARP_NO_CHECKPOINT),
		WARP_NODE(5, LEVEL_BOB, 1, 10, WARP_NO_CHECKPOINT),
		WARP_NODE(4, LEVEL_BOB, 1, 10, WARP_NO_CHECKPOINT),
		WARP_NODE(3, LEVEL_BOB, 1, 10, WARP_NO_CHECKPOINT),
		WARP_NODE(2, LEVEL_BOB, 1, 10, WARP_NO_CHECKPOINT),
		WARP_NODE(30, LEVEL_TTC, 1, 20, WARP_NO_CHECKPOINT),
		WARP_NODE(20, LEVEL_TTC, 1, 30, WARP_NO_CHECKPOINT),
		WARP_NODE(241, LEVEL_CASTLE, 1, 114, WARP_NO_CHECKPOINT),
		WARP_NODE(240, LEVEL_CASTLE, 1, 98, WARP_NO_CHECKPOINT),
		WARP_NODE(14, LEVEL_BOB, 1, 13, WARP_NO_CHECKPOINT),
		WARP_NODE(13, LEVEL_BOB, 1, 14, WARP_NO_CHECKPOINT),
		WARP_NODE(12, LEVEL_BOB, 1, 11, WARP_NO_CHECKPOINT),
		WARP_NODE(11, LEVEL_BOB, 1, 12, WARP_NO_CHECKPOINT),
		WARP_NODE(10, LEVEL_BOB, 1, 10, WARP_NO_CHECKPOINT),
		OBJECT(212, -2372, 2710, -4080, 0, -90, 0, 0x0, bhv1Up),
		OBJECT(212, -4262, 1635, -1700, 0, 0, 0, 0x0, bhv1Up),
		OBJECT_WITH_ACTS(129, 2039, -2075, -3466, 0, 0, 0, 0x0, bhvBreakableBox, ACT_3),
		OBJECT_WITH_ACTS(129, 2312, -2075, -2572, 0, 0, 0, 0x0, bhvBreakableBox, ACT_3),
		OBJECT_WITH_ACTS(129, 2086, -2075, -2369, 0, 0, 0, 0x0, bhvBreakableBox, ACT_3),
		OBJECT(129, -790, 3620, -3540, 0, 0, 0, 0x0, bhvBreakableBox),
		OBJECT(129, -1290, 4020, -3540, 0, 0, 0, 0x0, bhvBreakableBox),
		OBJECT(129, -1790, 4420, -3540, 0, 0, 0, 0x0, bhvBreakableBox),
		OBJECT(129, -2290, 4820, -3540, 0, 0, 0, 0x0, bhvBreakableBox),
		OBJECT_WITH_ACTS(84, -93, 3800, -4932, 0, 0, 0, 0x0, bhvBulletBill, ACT_2 | ACT_3 | ACT_4),
		OBJECT(187, 1309, -1919, -212, 0, 0, 0, 0x0, bhvButterfly),
		OBJECT(187, 1419, -1867, -4568, 0, 0, 0, 0x0, bhvButterfly),
		OBJECT(102, 2949, -2075, 1145, 0, 0, 0, 0x0, bhvChainChomp),
		OBJECT(0, 333, -573, 3962, 0, 0, 0, 0x0, bhvCheckerboardElevatorGroup),
		OBJECT(223, 2776, 367, 4228, 0, 0, 0, 0x0, bhvChuckya),
		OBJECT(223, 5993, 549, -522, 0, 0, 0, 0x0, bhvChuckya),
		OBJECT(0, -1411, -2075, -2720, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(0, 6194, -469, -5334, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -2281, 864, 5364, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -1482, -368, 1943, 0, 0, 0, 0x0, bhvCoinFormation),
		OBJECT(0, 3154, 367, 5500, 0, 0, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -2533, 6130, -5030, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(0, 6209, -1665, -1410, 0, 90, 0, 0x0, bhvCoinFormation),
		OBJECT(0, -1938, -2075, 2415, 0, 0, 0, 0x20000, bhvCoinFormation),
		OBJECT(0, 6175, 549, -2772, 0, 0, 0, 0x20000, bhvCoinFormation),
		OBJECT(0, -759, 2922, 2400, 90, 0, 0, 0x130000, bhvCoinFormation),
		OBJECT(0, 2511, 2782, 1847, 90, -62, 0, (20 << 16), bhvCoinFormation),
		OBJECT(34, -4958, -500, 4138, 0, -90, 0, 0x0, bhvDoor),
		OBJECT(34, -2472, -2075, 1941, 0, 90, 0, 0x0, bhvDoor),
		OBJECT(137, -4558, -365, 5271, 0, 0, 0, 0x4080000, bhvExclamationBox),
		OBJECT(137, 7081, 52, -6082, 0, 0, 0, 0x50000, bhvExclamationBox),
		OBJECT(137, -5746, -1658, 3245, 0, 0, 0, 0x40000, bhvExclamationBox),
		OBJECT(0, 583, 2683, -5387, 0, -154, 0, 0xb0000, bhvFadingWarp),
		OBJECT(0, 1680, 3835, -5523, 0, -153, 0, 0xc0000, bhvFadingWarp),
		OBJECT(0, -6612, 1024, -3351, 0, 107, 0, 0xd0000, bhvFadingWarp),
		OBJECT(0, 1980, 768, 6618, 0, -151, 0, 0xe0000, bhvFadingWarp),
		OBJECT_WITH_ACTS(180, 4446, -2075, -280, 0, 0, 0, 0x0, bhvFireSpitter, ACT_3),
		OBJECT_WITH_ACTS(180, 2604, -2075, -313, 0, 0, 0, 0x0, bhvFireSpitter, ACT_3),
		OBJECT_WITH_ACTS(180, 2083, -1676, -5833, 0, 0, 0, 0x0, bhvFireSpitter, ACT_3),
		OBJECT_WITH_ACTS(180, 3698, -1315, -5417, 0, 0, 0, 0x0, bhvFireSpitter, ACT_3),
		OBJECT(207, 129, 2830, 2460, 0, 0, 0, 0x0, bhvFloorSwitchHiddenObjects),
		OBJECT(220, -1060, 3073, 1024, 0, 0, 0, 0x0, bhvFlyGuy),
		OBJECT(192, 2025, -2075, -6371, 0, 0, 0, 0x10000, bhvGoomba),
		OBJECT(192, 4969, -2075, -403, 0, 0, 0, 0x10000, bhvGoomba),
		OBJECT(192, 1931, 367, 4186, 0, 0, 0, 0x10000, bhvGoomba),
		OBJECT(192, 2181, -2075, -1584, 0, 0, 0, 0x10000, bhvGoomba),
		OBJECT(0, -3694, -2075, 3726, 0, 0, 0, 0x10000, bhvGoombaTripletSpawner),
		OBJECT(0, -759, 2766, 2400, 0, 0, 0, 0x10000, bhvGoombaTripletSpawner),
		OBJECT(0, 6176, 549, -4720, 0, 0, 0, 0x10000, bhvGoombaTripletSpawner),
		OBJECT(129, -280, 3450, -2400, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, -280, 3450, -1300, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, -280, 3450, -200, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, -280, 3450, 900, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(129, -280, 3000, 1455, 0, 0, 0, 0x0, bhvHiddenObject),
		OBJECT(0, -5508, -1783, 851, 0, 0, 0, 0x3000000, bhvHiddenRedCoinStar),
		OBJECT(129, 4206, -2075, -6401, 0, 0, 0, 0x0, bhvJumpingBox),
		OBJECT_WITH_ACTS(104, 4831, -2075, -2873, 0, 0, 0, 0x2030000, bhvKoopa, ACT_3),
		OBJECT_WITH_ACTS(0, 4931, -1025, -4431, 0, 0, 0, 0x0, bhvKoopaRaceEndpoint, ACT_3),
		OBJECT(116, -4225, -1697, -5984, 0, 0, 0, 0x0, bhvOneCoin),
		OBJECT(116, 7369, -1865, -891, 0, 0, 0, 0x0, bhvOneCoin),
		OBJECT(0, 1755, 367, 2918, 0, 0, 0, 0xb50000, bhvPoleGrabbing),
		OBJECT(0, 3100, 2700, 2065, 0, 0, 0, 0xb50000, bhvPoleGrabbing),
		OBJECT(0, 3310, 4100, 2645, 0, 0, 0, 0x870000, bhvPoleGrabbing),
		OBJECT(215, 5529, -885, -6109, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -1248, -1955, 3980, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 6520, -1198, 841, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -4253, -2180, 1962, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -5723, -500, 4125, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -3850, -2075, 5278, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, 2360, 2061, 5190, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(215, -4145, -1314, -5309, 0, 0, 0, 0x0, bhvRedCoin),
		OBJECT(0, -5485, -1196, -2723, 0, 90, 0, 0xa0000, bhvSpinAirborneWarp),
		OBJECT(122, 3329, 5996, 2582, 0, 0, 0, 0x0, bhvStar),
		OBJECT(122, -122, 6328, -4999, 0, 0, 0, 0x1000000, bhvStar),
		OBJECT(122, 6617, -2894, -2490, 0, 0, 0, 0x5000000, bhvStar),
		OBJECT(88, 3100, 4596, 2065, 0, -90, 0, 0x0, bhvThwomp),
		OBJECT(88, 6617, -3125, -2490, 0, 90, 0, 0x0, bhvThwomp),
		OBJECT(23, 3701, 367, 5668, 0, 0, 0, 0x0, bhvTree),
		OBJECT(187, -3979, -1865, -2899, 0, 0, 0, 0x0, bhvTripletButterfly),
		OBJECT_WITH_ACTS(22, -1899, 2760, 2660, 0, 90, 0, 0x140000, bhvWarpPipe, ACT_2 | ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT_WITH_ACTS(22, -2891, -2100, 765, 0, 0, 0, 0x1e0000, bhvWarpPipe, ACT_2 | ACT_3 | ACT_4 | ACT_5 | ACT_6),
		OBJECT(107, -3050, -2075, 2956, 0, 0, 0, 0x0, bhvWoodenPost),
		OBJECT(107, 5224, -2075, 1179, 0, 0, 0, 0x0, bhvWoodenPost),
		TERRAIN(ttc_area_1_collision),
		MACRO_OBJECTS(ttc_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 2),
		TERRAIN_TYPE(TERRAIN_GRASS),
		/* Fast64 begin persistent block [area commands] */
		/* Fast64 end persistent block [area commands] */
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
